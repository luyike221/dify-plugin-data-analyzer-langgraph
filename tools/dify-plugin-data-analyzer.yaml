identity:
  name: "dify-plugin-data-analyzer"
  author: "luyike"
  label:
    en_US: "dify-plugin-data-analyzer"
    zh_Hans: "dify-plugin-data-analyzer"
    pt_BR: "dify-plugin-data-analyzer"
    ja_JP: "dify-plugin-data-analyzer"
description:
  human:
    en_US: "Intelligent Excel Analysis API - Automated multi-level header processing and AI-powered data analysis with code generation and execution"
    zh_Hans: "Intelligent Excel Analysis API - Automated multi-level header processing and AI-powered data analysis with code generation and execution"
    pt_BR: "Intelligent Excel Analysis API - Automated multi-level header processing and AI-powered data analysis with code generation and execution"
    ja_JP: "Intelligent Excel Analysis API - Automated multi-level header processing and AI-powered data analysis with code generation and execution"
  llm: "Intelligent Excel Analysis API - Automated multi-level header processing and AI-powered data analysis with code generation and execution"
parameters:
  - name: input_file
    type: file
    required: true
    label:
      en_US: Upload File
      zh_Hans: 上传文件
      pt_BR: Upload File
      ja_JP: ファイルをアップロード
    human_description:
      en_US: "Upload an Excel file to process and analyze"
      zh_Hans: "上传需要处理的Excel文件"
      pt_BR: "Envie um arquivo Excel para processar e analisar"
      ja_JP: "処理および分析するExcelファイルをアップロード"
    llm_description: "Excel file to be analyzed. Supports .xlsx, .xls, .xlsm, .xlsb formats."
    form: form
  - name: query
    type: string
    required: false
    label:
      en_US: Analysis Query
      zh_Hans: 分析查询
      pt_BR: Consulta de Análise
      ja_JP: 分析クエリ
    human_description:
      en_US: "Optional: Custom analysis prompt or query for the data analysis"
      zh_Hans: "可选：自定义分析提示词或查询语句"
      pt_BR: "Opcional: Prompt de análise personalizado ou consulta para análise de dados"
      ja_JP: "オプション：データ分析のカスタム分析プロンプトまたはクエリ"
    llm_description: "Optional custom analysis prompt. If not provided, default comprehensive analysis will be performed."
    form: llm
  - name: use_llm_header_validation
    type: boolean
    required: false
    default: true
    label:
      en_US: "Enable LLM Header Validation"
      zh_Hans: "启用LLM表头验证"
      pt_BR: "Habilitar Validação de Cabeçalho LLM"
      ja_JP: "LLMヘッダー検証を有効にする"
    human_description:
      en_US: "Enable LLM-based header validation for more accurate header analysis. Requires LLM API key configured in provider settings."
      zh_Hans: "启用基于LLM的表头验证，提高表头分析准确性。需要在提供者设置中配置LLM API密钥。"
      pt_BR: "Habilite a validação de cabeçalho baseada em LLM para análise de cabeçalho mais precisa. Requer chave de API LLM configurada nas configurações do provedor."
      ja_JP: "より正確なヘッダー分析のためにLLMベースのヘッダー検証を有効にします。プロバイダー設定でLLM APIキーの設定が必要です。"
    llm_description: "Whether to use LLM for header validation. Default: true. Requires LLM API key in provider credentials."
    form: form
  - name: thread_id
    type: string
    required: false
    label:
      en_US: Session ID
      zh_Hans: 会话ID
      pt_BR: ID da Sessão
      ja_JP: セッションID
    human_description:
      en_US: "Optional: Session ID generated by Dify (e.g., from conversation_id variable). Leave empty to create a new session."
      zh_Hans: "可选：由Dify生成的会话ID（例如从conversation_id变量获取）。留空则创建新会话。"
      pt_BR: "Opcional: ID da sessão gerado pelo Dify (por exemplo, da variável conversation_id). Deixe vazio para criar uma nova sessão."
      ja_JP: "オプション：Difyによって生成されたセッションID（例：conversation_id変数から）。空欄の場合は新しいセッションを作成します。"
    llm_description: "Optional session ID generated by Dify workflow variables (e.g., conversation_id). If not provided, a new session will be created. Multiple files can be processed in the same session by using the same thread_id."
    form: llm
  - name: sheet_name
    type: string
    required: false
    label:
      en_US: "Sheet Name"
      zh_Hans: "工作表名称"
      pt_BR: "Nome da Planilha"
      ja_JP: "シート名"
    human_description:
      en_US: "Optional: Specify the sheet name to process. If not provided, the first sheet will be processed. You can check available sheets in the processing output."
      zh_Hans: "可选：指定要处理的工作表名称。如果不提供，将处理第一个工作表。可以在处理输出中查看可用工作表。"
      pt_BR: "Opcional: Especifique o nome da planilha a ser processada. Se não fornecido, a primeira planilha será processada. Você pode verificar as planilhas disponíveis na saída do processamento."
      ja_JP: "オプション：処理するシート名を指定。指定しない場合、最初のシートが処理されます。処理出力で利用可能なシートを確認できます。"
    llm_description: "Optional sheet name to process. If not provided, the first sheet (active sheet) will be processed. Leave empty to use the default sheet."
    form: llm
# 流式输出配置 - 支持在 Chatflow Answer 节点中使用打字机效果
output_schema:
  type: object
  properties:
    stream_output:
      type: string
      description: "实时流式输出的分析过程，包含进度信息和LLM响应（支持打字机效果）"
    thread_id:
      type: string
      description: "会话ID，由Dify自动生成并传入（conversation_id）。如果Dify未提供会话ID，插件会创建内部会话ID。此ID用于在同一会话中处理多个文件。"

extra:
  python:
    source: tools/dify-plugin-data-analyzer.py
